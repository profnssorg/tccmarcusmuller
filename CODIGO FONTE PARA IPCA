# IMPORTAMOS OS PACOTES NECESSARIOS
import pandas as pd
import numpy as np
import plotly as py
from IPython.display import display

# RREALIZAMOS A LEITURA DOS DADOS
dataset = pd.read_excel('C:/Users/Marcus/Desktop/METADADOS/IPCA.xlsx', index_col=None, na_values=["NA"])

#TRANSFORMAMOS A COLUNA DATA EM UMA VARIAVEL DATETIME
dataset['Data'] = pd.to_datetime(dataset['Data'])

#TRANSFORMAMOS A COLUNA DCOILWTICO DE UMA STRING PARA UMA VARIAVEL FLOAT
dataset['NI'] = pd.to_numeric(dataset['NI'])

#CRIAMOS UM DATASET DO PERIODO T-1 E APLICAMOS O LOG NA COLUNA CLOSE
dataset_1 = dataset.drop(dataset.index[0])
dataset_1 = dataset_1.reset_index(drop=True)
dataset_1["log_1"] = dataset_1["NI"].apply(np.log)

#CRIAMOS UM DATASET DO PERIODO T PARA APLICARMOS O LOG
dataset_0 = dataset
dataset_0["log_0"] = dataset_0["NI"].apply(np.log)
dataset_0.head()

#CONCATENAMOS OS DATASET_1 E DATASET_0 NA MATRIZ RESULT
result = pd.concat([dataset_0, dataset_1], axis=1)

#ADICIONAMOS A COLUNA RETURNS A MATRIZ RESULT
result["Returns_IPCA"] = result["log_1"]-result["log_0"]

#CRIAMOS UM NOVO CSV APOS A MANINULACAO DOS DADOS
result.to_csv('M_IPCA.csv')
result.head()
